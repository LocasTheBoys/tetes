local TTD = require(game:GetService("ReplicatedStorage").MultiboxFramework)
local save = TTD.Replicate:WaitForReplica("PlayerData-" .. game:GetService("Players").LocalPlayer.UserId)
local Network = TTD.Network
local Invoke = Network.Invoke
local Fire = Network.Fire

local function getInventoryTroops()
    local invTroops = {}
    local save = TTD.Replicate:WaitForReplica("PlayerData-" .. game:GetService("Players").LocalPlayer.UserId)
    for name, v in pairs(save._data.Inventory.Troops) do
        for i, v in pairs(v) do
            invTroops[i] = name
        end
    end
    return invTroops
end

local function tradeItem(fromUser, toUser, itemId, itemType)
    -- Dapatkan User ID dari nama pengguna
    local toUserId = game.Players:GetUserIdFromNameAsync(toUser)
    
    -- Kirim trade
    Fire("PostOffice_SendGift", toUserId, itemType, itemId, 0, tostring(math.random(1, 10000)))
    print("Trade sent from " .. fromUser .. " to " .. toUser .. " for item: " .. itemId)
end

local function tradeTroops(fromUser, toUser, troopsToTrade)
    for _, troop in ipairs(troopsToTrade) do
        local inventory = getInventoryTroops()
        for itemId, troopName in pairs(inventory) do
            if troopName == troop then
                tradeItem(fromUser, toUser, itemId, "Troops")
            end
        end
    end
end

-- Contoh penggunaan
local fromUser = game.Players.LocalPlayer.Name
local toUser = "strob5ck" -- Ganti dengan username tujuan
local troopsToTrade = {"SantaTVMan", "LuckySpeakerman"} -- Daftar troop yang ingin ditrade

tradeTroops(fromUser, toUser, troopsToTrade)
